#include <Arduino.h>
#include "TFT_eSPI.h"
#include "TFT_UI/TFT_UI.h"
#include "Landscape yellow flower 480 x 320 verti 2.h"
#include "wifi-transparen2 40x40.h"
#define BL 4
#define NUM_SECTIONS 4
// TFT_eSPI tft = TFT_eSPI();

TFT_eSPI tft = TFT_eSPI();
TFT_eSprite sprite0(&tft);
TFT_eSprite sprite1(&tft);
TFT_eSprite sprite2(&tft);
TFT_eSprite sprite3(&tft);
TFT_eSprite *sprites[4] = {&sprite0, &sprite1, &sprite2, &sprite3};
TFT_UI ui(&tft, sprites);

void setup()
{
  Serial.begin(115200);

  pinMode(BL, OUTPUT);
  digitalWrite(BL, HIGH);
  tft.init();
  tft.setRotation(0);
  tft.setSwapBytes(true);
  tft.fillScreen(TFT_BLACK);

  tft.setTextColor(TFT_WHITE, TFT_BLACK);
  tft.drawString("Starting vertical tile rendering...", 10, 10, 2);

  ui.setRenderDirection(false); // true = vertical rendering
  ui.init(320, 480, 4, 2);

  delay(500);
  Serial.println("Vertical tile rendering system initialized!");
}

unsigned long lastFrameTime = 0;
float fps = 0;

void loop()
{

  unsigned long now = millis();
  if (now - lastFrameTime > 0)
  {
    fps = 1000 / (now - lastFrameTime);
  }


  ui.drawBackground(image_data_Landscapeyellowflower480x320verti2);
  //ui.drawBox(0, 0, 80, 80, 10, TFT_RED);
  ui.setTextStyle(2, TFT_CYAN);
  ui.setFontStyle(MC_DATUM,TFT_WHITE,&FreeSansBold9pt7b);
  // Draw FPS text (top-left corner)
  String fpsText = "FPS: " + String(fps);
  //ui.hexTo565();
  std::vector<String> menuItems = {"0","1","2","3","4","5","6","7","8"};
  
  ui.drawIcon(140,200,40,40,image_data_wifitransparen240x40,0x0000);
  ui.drawIcon(140,-200,40,40,image_data_wifitransparen240x40,0x0000);
  ui.drawText(fpsText, 0, 140);
  ui.drawMenuHighlight(NULL, NULL, -1);
  ui.drawMenuSet(0,0);
  ui.drawMenu(3, 3, 50, 50, 10, TFT_LIGHTGREY, NULL, NULL, 5, 5, menuItems);
  ui.drawMenuSet(0,-140);
  ui.drawMenu(1, 2, 100, 80, 10, TFT_BLACK, TFT_ORANGE ,3 , 5, 5, std::vector<String>());
  ui.drawMenuSet(0,140);
  ui.drawMenu(1, 2, 100, 80, 40,  ui.hexTo565(0xFCB32C), NULL, NULL, 5  , 5, std::vector<String>());

  ui.drawCircle(-140,-200,20,TFT_GREEN);
  ui.drawBox(-140,180, 50,50,10,TFT_MAGENTA);
  ui.drawBorder(50,200,90,30,15,TFT_PINK,5);

  ui.drawText("FONT TEST",0,-140);
  //ui.drawRender();
  int randNum = random(0, 1000); // Generates random number between 0â€“999
  ui.setFontStyle(MC_DATUM,TFT_BLACK,&FreeMonoBold9pt7b);
  String randText = "Rand: " + String(randNum);
  ui.drawText(randText, 0, -200); // Top-center position
  ui.drawRender(); // <- MAKE SURE THIS CALLED LAST


    lastFrameTime = now;
}
